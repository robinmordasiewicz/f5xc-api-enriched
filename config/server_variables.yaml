# Server Variables Configuration for F5 Distributed Cloud API
# Single source of truth for multi-environment, multi-tenant, and multi-region deployments
#
# Defines 6 OpenAPI server variables supporting comprehensive API configuration:
# - URL components: tenant, console_url, namespace
# - Configuration variables: environment, region, domain_prefix

version: "2.0.0"

# Server configuration
server:
  url_template: "https://{tenant}.{console_url}/api/v1/{domain_prefix}/{environment}/{region}/namespaces/{namespace}"
  description: "F5 Distributed Cloud Console"

# Variable definitions (all 6 active variables)
variables:
  # Tenant variable: Explicit tenant identifier
  tenant:
    default: "example-corp"
    description: "F5 Distributed Cloud tenant identifier (e.g., my-company, acme-inc)"
    examples:
      - "example-corp"
      - "acme-inc"
      - "my-company"
    env_var: "F5XC_TENANT"
    notes: |
      Default comes from F5XC_TENANT environment variable if set.
      Extracted from the api_url subdomain (e.g., tenant.console.ves.volterra.io).
      Required for multi-tenant deployments.

  # Console URL variable: Console base URL
  console_url:
    default: "console.ves.volterra.io"
    description: "Console URL base (e.g., console.ves.volterra.io for production, staging.volterra.us for staging)"
    examples:
      - "console.ves.volterra.io"    # Production
      - "staging.volterra.us"         # Staging
      - "custom-api.f5xc.io"          # Custom environment
    enum:
      - "console.ves.volterra.io"
      - "staging.volterra.us"
    env_var: "F5XC_CONSOLE_URL"
    notes: |
      Default comes from F5XC_CONSOLE_URL environment variable if set.
      Encodes both environment (production/staging/custom) and hosting region.
      Part of the hostname structure: https://[tenant].[console_url]/...

  # Environment variable: Explicit environment designation
  environment:
    default: "production"
    description: "Environment designation (production, staging, development)"
    examples:
      - "production"
      - "staging"
      - "development"
    enum:
      - "production"
      - "staging"
      - "development"
    env_var: "F5XC_ENVIRONMENT"
    notes: |
      Default comes from F5XC_ENVIRONMENT environment variable if set.
      Used for explicit environment selection and configuration.
      Can be combined with console_url for additional environment control.

  # Domain prefix variable: Industry-standard naming conventions
  domain_prefix:
    default: "api"
    description: "Domain naming prefix for consistent naming conventions"
    examples:
      - "api"        # Standard API subdomain
      - "api-edge"   # Edge API variant
      - "internal"   # Internal API
    env_var: "F5XC_DOMAIN_PREFIX"
    notes: |
      Default comes from F5XC_DOMAIN_PREFIX environment variable if set.
      Supports industry-standard naming conventions (api, api-edge, etc).
      Available for advanced use cases and custom deployments.

  # Region variable: Geographic region for multi-region deployments
  region:
    default: "us-east-1"
    description: "Geographic region for API deployment (e.g., us-east-1, eu-west-1)"
    examples:
      - "us-east-1"
      - "us-west-1"
      - "eu-west-1"
      - "eu-central-1"
      - "ap-northeast-1"
    env_var: "F5XC_REGION"
    notes: |
      Default comes from F5XC_REGION environment variable if set.
      Enables multi-region deployment patterns with geographic routing.
      Used for region-aware API configuration and failover strategies.

  # Namespace variable: Kubernetes-style environment separation
  namespace:
    default: "default"
    description: "Kubernetes-style namespace for environment separation (e.g., 'default', 'production', 'staging')"
    examples:
      - "default"        # Default/fallback namespace
      - "production"     # Explicit production namespace
      - "main"           # Production namespace (main branch)
      - "feature-123"    # Feature branch namespace
      - "bugfix-456"     # Bugfix branch namespace
      - "staging"        # Staging environment namespace
    env_var: "F5XC_DEFAULT_NAMESPACE"
    naming_pattern: "[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?"  # RFC 1123 compliant
    notes: |
      Default comes from F5XC_DEFAULT_NAMESPACE environment variable if set.
      Supports Kubernetes-style namespace naming for environment separation.
      Enables zero-downtime deployments with namespace-based isolation.

# GitHub branch mapping (for future CI/CD integration)
github_branch_mapping:
  enabled: true  # Set to true when CI/CD integration is implemented
  patterns:
    main: "main"                          # Production namespace
    master: "main"                        # Alternate main branch
    "feature/*": "feature-*"              # Feature branches: extract issue number
    "bugfix/*": "bugfix-*"                # Bugfix branches: extract issue number
    "hotfix/*": "hotfix-*"                # Hotfix branches: extract issue number
    staging: "staging"                    # Staging branch
    develop: "dev"                        # Development branch
    default: "default"                    # Fallback for unmatched branches

# Documentation and guidelines
documentation:
  multi_environment_strategy: |
    The API supports multi-environment deployments through OpenAPI server variables:

    - **Tenant**: Your F5 XC tenant account (default: "console")
    - **Namespace**: Kubernetes-style environment separation (default: "default")

    GitHub-based deployment strategy:
    - main branch → production namespace "main"
    - feature/issue-{num} → feature namespace "feature-{num}"
    - bugfix/issue-{num} → bugfix namespace "bugfix-{num}"
    - staging branch → staging namespace "staging"
    - Other branches → default namespace "default"

    This enables zero-downtime deployments with namespace-based isolation
    and prevents accidental production conflicts.

  extensibility_notes: |
    This configuration is designed for future expansion:

    Phase 1 (Current): Namespace support for environment separation
    - Multi-environment separation (prod vs dev)
    - GitHub branch awareness (branch → namespace mapping)
    - Framework for future expansion

    Phase 2 (Future): Region & Environment Variables
    - Add `region` variable for multi-region deployments
    - Add `environment` variable for explicit prod/staging/dev designation
    - Combine with namespace for comprehensive multi-environment control

    Phase 3 (Future): Domain Naming Support
    - Add `domain_prefix` variable for industry-standard conventions
    - Support consistent branding across deployments
    - Enable reusable deployment patterns with "example-" prefixes

    To extend this framework:
    1. Define new variables in the future_variables section
    2. Move to variables section when implementation starts
    3. Update server URL template if the variable is used in URL paths
    4. Add GitHub branch mapping patterns if CI/CD integration is planned
    5. Update CLAUDE.md with usage documentation
