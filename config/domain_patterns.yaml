# Domain categorization patterns for F5 XC API specifications
# Single source of truth for mapping spec filenames to functional domains
#
# PATTERN MATCHING RULES:
#   - Patterns are matched sequentially by domain order
#   - First matching pattern determines domain assignment
#   - Both literal strings and regex patterns are supported
#
# COMPLEX PATTERNS DOCUMENTED:
#   - (?<!dns_lb)\.healthcheck\.ves: Matches healthcheck.ves EXCEPT dns_lb_*
#     (negative lookahead pattern)
#   - ^[^.]*\.route\.ves: Matches route.ves specs at root namespace level
#   - api_sec\.: Regex - matches API security specs with dot separator
#   - \.site\.: Regex - matches site-related specs using dot separators
#
# ARCHITECTURAL DISTINCTIONS:
#   - container_services: Virtual Kubernetes (vK8s) - SaaS managed namespaces
#     * Multi-tenant, simplified, zero-touch deployment
#     * Optimized for distributed edge deployments (100s-1000s of sites)
#     * Restricted K8s capabilities: no operators, CRDs, privileged mode
#   - managed_kubernetes: Enterprise Kubernetes (mK8s) - full cluster management
#     * Customer-owned infrastructure with centralized F5 management
#     * Complete Kubernetes API access, operators, CRDs supported
#     * Comparable to AWS EKS, Azure AKS, GCP GKE management APIs
#   - sites: Customer Edge deployments (AppStack and Mesh)
#     * voltstack_site: AppStack deployments (on-premises, certified hardware)
#     * securemesh_site: Secure Mesh deployments (networking focused)
#     * k8s_cluster: CE deployed as pods in existing K8s clusters
#
version: "1.4.0"
description: >
  35 functional domains organized in 11 categories, aligned with
  F5 XC platform services. Kubernetes domains reorganized:
  - kubernetes_and_orchestration split into container_services (vK8s) and managed_kubernetes (cluster management)
  - container_services: Virtual Kubernetes SaaS managed namespaces
  - managed_kubernetes: Enterprise K8s cluster management (RBAC, security, registry)
  Pattern fixes from natural identifier validation:
  - Shape Security domain in Security - Core section (pattern priority)
  - TPM patterns moved to bot_and_threat_defense (threat management)
  - VoltShare/secret_management moved to blindfold (secrets domain)
  - Fleet moved to ce_management (edge site fleet)
  - Virtual_network moved to network (L3 overlay)
  - Discovery pattern removed from service_mesh (caught by api domain)

domains:
  # ===== A. Infrastructure & Deployment (5 categories) =====
  ce_management:
    description: "Customer Edge"
    patterns:
      - "registration"
      - "module_management"
      - "upgrade_status"
      - "maintenance_status"
      - "usb_policy"
      - "network_interface"
      # Fleet - edge site fleet management (moved from service_mesh)
      - "fleet"

  cloud_infrastructure:
    description: "Cloud connectivity and credentials"
    patterns:
      - "cloud_credentials"
      - "cloud_connect"
      - "cloud_elastic"
      - "cloud_link"
      - "cloud_region"
      - "certified_hardware"

  container_services:
    description: "XCCS (XC Container Services) - Multi-tenant SaaS managed container namespaces"
    # F5 XC Container Services (XCCS) - comparable to AWS ECS, Azure Container Services
    # Optimized for distributed edge deployments (100s-1000s of sites)
    # Restricted K8s capabilities: no operators, CRDs, privileged mode
    # Formerly known as "Virtual Kubernetes" (vK8s)
    patterns:
      - "virtual_kubernetes"
      - "virtual_k8s"
      - "workload"
      - "workload_flavor"

  managed_kubernetes:
    description: "XCKS (XC Kubernetes Service) - Enterprise cluster management"
    # F5 XC Managed Kubernetes (XCKS) - comparable to AWS EKS, Azure AKS, Google GKE
    # Full cluster management for customer-owned infrastructure
    # RBAC, pod security, container registry management
    # Formerly known as "AppStack"
    # Note: k8s_cluster (site type) stays in sites domain
    patterns:
      - "k8s_cluster_role"
      - "k8s_cluster_role_binding"
      - "k8s_pod_security"
      - "container_registry"

  service_mesh:
    description: "Service mesh and networking services"
    patterns:
      - "site_mesh"
      # Specific endpoint pattern - requires dot-ves suffix
      - "schema\\.endpoint\\.ves"
      - "nfv_service"
      - "app_setting"
      - "app_type"
      - "virtual_appliance"
      # NOTE: fleet moved to ce_management domain
      # NOTE: virtual_network moved to network domain
      # NOTE: virtual_host matched by virtual domain (.virtual_host.ves pattern)
      # NOTE: discovery matched by api domain (.discovery.ves pattern)

  sites:
    description: "Customer Edge Sites - Cloud, XCKS (Managed Kubernetes), and Mesh deployments"
    # Site deployment and management across cloud providers (AWS VPC, Azure VNET, GCP VPC),
    # F5 XC Managed Kubernetes (XCKS, formerly AppStack), and Secure Mesh deployments.
    patterns:
      - "aws_vpc_site"
      - "aws_tgw_site"
      - "azure_vnet_site"
      - "gcp_vpc_site"
      - "voltstack_site"
      - "securemesh_site"
      - "virtual_site"
      # k8s_cluster represents deployment of F5 Customer Edge as pods within an
      # external Kubernetes cluster (site type for existing K8s clusters owned by
      # customer organization). Supports Mesh only, not AppStack. Different from
      # managed Kubernetes configuration objects accessed via kubernetes domain APIs.
      - "k8s_cluster"
      - "site_management"
      - "\\.site\\."

  # ===== B. Security - Core (5 categories) =====
  # Shape Security must be matched FIRST to prevent shape.* specs from being
  # caught by other patterns (subscription, data_delivery, client_side_defense, etc.)
  shape:
    description: "Shape Security - Bot detection, client-side defense, data delivery"
    patterns:
      - "shape\\."

  api:
    description: "API security, discovery, and testing"
    patterns:
      - "api_sec\\."
      - "api_crawler"
      - "api_credential"
      - "api_definition"
      - "api_discovery"
      - "api_group"
      - "api_testing"
      - "code_base_integration"
      # Discovery - API discovery and exploration (moved from service_mesh)
      - "\\.discovery\\.ves"

  waf:
    description: "Web Application Firewall"
    patterns:
      - "app_firewall"
      - "app_security"
      - "enhanced_firewall"
      - "protocol_inspection"
      - "waf"

  bot_and_threat_defense:
    description: "Bot defense and threat intelligence"
    patterns:
      - "bot_allowlist"
      - "bot_defense"
      - "bot_endpoint"
      - "bot_infrastructure"
      - "bot_network"
      - "mobile_base"
      - "mobile_sdk"
      - "threat_intelligence"
      # TPM (Trusted Platform Module) patterns for bot/threat management
      - "tpm_"

  network_security:
    description: "Network firewall and policies"
    patterns:
      - "fast_acl"
      - "filter_set"
      - "forward_proxy"
      - "nat_policy"
      - "network_firewall"
      - "network_policy"
      - "policy_based_routing"
      - "segment"

  # ===== C. Security - Advanced (4 categories) =====
  blindfold:
    description: "Secret policy, encryption, and secret management"
    patterns:
      - "secret_policy"
      # VoltShare - secure data sharing (moved from marketplace)
      - "voltshare"
      # Secret management - key/credential management (moved from secops)
      - "secret_management"

  data_and_privacy_security:
    description: "Data privacy and protection"
    patterns:
      - "client_side_defense"
      - "data_privacy"
      - "data_type"
      - "device_id"
      - "sensitive_data_policy"

  secops_and_incident_response:
    description: "Security operations and incident response"
    patterns:
      - "malicious_user"
      # NOTE: secret_management moved to blindfold domain

  ddos:
    description: "Distributed denial of service protection"
    patterns:
      - "infraprotect"

  dns:
    description: "DNS load balancing"
    patterns:
      - "dns_compliance"
      - "dns_domain"
      - "dns_and_domain_management"
      - "dns_lb_"
      - "dns_load_balancer"
      - "dns_zone"
      - "rrset"

  virtual:
    description: "Virtual Services - HTTP, TCP, UDP Load Balancing"
    patterns:
      - "geo_location_set"
      - "http_loadbalancer"
      - "malware_protection"
      - "service_policy"
      - "threat_campaign"
      - "origin_pool"
      - "views\\.forward_proxy_policy"
      - "views\\.http_loadbalancer"
      - "views\\.origin_pool"
      - "views\\.proxy\\.ves"
      - "views\\.rate_limiter_policy"
      - "views\\.tcp_loadbalancer"
      - "views\\.udp_loadbalancer"
      - "(?<!dns_lb)\\.healthcheck\\.ves"
      - "\\.virtual_host\\.ves"
      - "^[^.]*\\.route\\.ves"
      # Load balancing clusters (backend endpoint groups) - NOT Kubernetes clusters
      - "\\.cluster\\."

  network:
    description: "Routing, Tunnelling, and Network Connectivity"
    patterns:
      - "address_allocator"
      - "advertise_policy"
      - "bgp"
      - "bgp_asn"
      - "bgp_routing"
      - "dc_cluster_group"
      - "forwarding_class"
      - "ike1"
      - "ike2"
      - "ike_phase"
      - "ip_prefix_set"
      - "network_connector"
      - "public_ip"
      - "route"
      - "segment_connection"
      - "srv6"
      - "subnet"
      - "tunnel"
      # Virtual network - L3 network overlay (moved from service_mesh)
      - "virtual_network"

  cdn:
    description: "Content delivery network services"
    patterns:
      - "cdn_"
      - "cdn_cache"
      - "cdn_loadbalancer"
      - "data_delivery"

  observability:
    description: "Synthetic monitoring and testing"
    patterns:
      - "observability\\."
      - "observability_and_analytics"
      - "synthetic_monitor"

  statistics:
    description: "Statistics"
    patterns:
      - "alert"
      - "alert_policy"
      - "alert_receiver"
      - "brmalerts"
      - "discovered_service"
      - "flow"
      - "global_log_receiver"
      - "graph"
      - "log"
      - "log_receiver"
      - "report"
      - "status_at_site"
      - "topology"

  support:
    description: "Support and ticket tracking"
    patterns:
      - "customer_support"
      - "operate\\."
      - "ticket_tracking"

  tenant_and_identity:
    description: "Tenant management, authentication, and core system"
    patterns:
      - "contact"
      - "namespace"
      - "rbac_policy"
      - "role"
      - "tenant"
      - "tenant_management"
      - "user"
      - "user_group"
      - "authentication"
      - "oidc_provider"
      - "scim"
      - "signup"
      - "api_credential"

  users:
    description: "User accounts and settings"
    patterns:
      - "implicit_label"
      - "known_label"
      - "token"
      - "user_identification"
      - "user_setting"
      - "was\\.user"

  # ===== I. Platform & Integrations (3 categories) =====
  bigip:
    description: "BigIP"
    patterns:
      - "bigcne"
      - "bigip"
      - "data_group"
      - "irule"

  marketplace:
    description: "Platform marketplace and integrations"
    patterns:
      - "addon_"
      - "cminstance"
      - "marketplace"
      - "pbac\\."
      # NOTE: tpm_ moved to bot_and_threat_defense domain
      # NOTE: voltshare moved to blindfold domain
      - "views\\.external"
      - "views\\.terraform"
      - "views\\.third_party"
      - "views\\.view_internal"

  object_storage:
    description: "Object storage and data persistence"
    patterns:
      - "stored_object"

  nginx_one:
    description: "NGINX One management platform"
    patterns:
      - "nginx"

  # ===== J. Advanced & Emerging (5 categories) =====
  certificates:
    description: "Certificate Management"
    patterns:
      - "certificate"
      - "config"
      - "crl"
      - "manifest"
      - "trusted_ca"

  ai_services:
    description: "AI and machine learning features"
    patterns:
      - "ai_assistant"
      - "ai_data"
      - "flow_anomaly"
      - "\\.gia\\."

  rate_limiting:
    description: "Rate limiting"
    patterns:
      - "policer"
      - "rate_limiter"

  # NOTE: shape domain moved to Security - Core section (must match before other patterns)

  # ===== K. UI & Platform Infrastructure (3 categories) =====
  admin_console_and_ui:
    description: "Administration console and user interface"
    patterns:
      - "navigation_tile"
      - "ui\\."
      - "ui_static"

  billing_and_usage:
    description: "Billing, subscription, and usage"
    patterns:
      - "billing\\."
      - "payment_method"
      - "plan_transition"
      - "quota"
      - "subscription"
      - "usage"
      - "usage_invoice"

  label:
    description: "Labels and compliance management"
    patterns:
      - "label"
