# Domain categorization patterns for F5 XC API specifications
# Single source of truth for mapping spec filenames to functional domains
#
# PATTERN MATCHING RULES:
#   - Patterns are matched sequentially by domain order
#   - First matching pattern determines domain assignment
#   - Both literal strings and regex patterns are supported
#
# COMPLEX PATTERNS DOCUMENTED:
#   - (?<!dns_lb)\.healthcheck\.ves: Matches healthcheck.ves EXCEPT dns_lb_*
#     (negative lookahead pattern)
#   - ^[^.]*\.route\.ves: Matches route.ves specs at root namespace level
#   - api_sec\.: Regex - matches API security specs with dot separator
#   - \.site\.: Regex - matches site-related specs using dot separators
#
# ARCHITECTURAL DISTINCTIONS:
#   - container_services: Virtual Kubernetes (vK8s) - SaaS managed namespaces
#     * Multi-tenant, simplified, zero-touch deployment
#     * Optimized for distributed edge deployments (100s-1000s of sites)
#     * Restricted K8s capabilities: no operators, CRDs, privileged mode
#   - kubernetes: Enterprise Kubernetes (mK8s) - full cluster management
#     * Customer-owned infrastructure with centralized F5 management
#     * Complete Kubernetes API access, operators, CRDs supported
#     * Comparable to AWS EKS, Azure AKS, GCP GKE
#
version: "1.1.0"
description: >
  34 functional domains organized in 11 categories, aligned with
  F5 XC platform services. Split container_services from kubernetes to
  distinguish Virtual Kubernetes (managed namespace) from enterprise
  Kubernetes cluster management

domains:
  # ===== A. Infrastructure & Deployment (5 categories) =====
  customer_edge:
    description: "Customer Edge"
    patterns:
      - "registration"
      - "module_management"
      - "upgrade_status"
      - "maintenance_status"
      - "usb_policy"
      - "network_interface"

  cloud_infrastructure:
    description: "Cloud connectivity and credentials"
    patterns:
      - "cloud_credentials"
      - "cloud_connect"
      - "cloud_elastic"
      - "cloud_link"
      - "cloud_region"
      - "certified_hardware"

  container_services:
    description: "Virtual Kubernetes and simplified container orchestration"
    patterns:
      - "virtual_kubernetes"
      - "virtual_k8s"
      - "virtual_site"
      - "virtual_network"
      - "virtual_host"
      - "virtual_appliance"
      - "fleet"
      - "secret_management"
      - "workload"

  kubernetes:
    description: "Enterprise Kubernetes cluster management"
    patterns:
      - "k8s_pod_security"
      - "container_registry"
      - "\\.cluster\\."

  service_mesh:
    description: "Service mesh and virtual networking"
    patterns:
      - "site_mesh"
      - "endpoint"
      - "nfv_service"
      - "discovery"
      - "app_setting"
      - "app_type"

  site:
    description: "Sites"
    patterns:
      - "aws_vpc_site"
      - "aws_tgw_site"
      - "azure_vnet_site"
      - "gcp_vpc_site"
      - "voltstack_site"
      - "securemesh_site"
      # k8s_cluster represents deployment of F5 Customer Edge as pods within an
      # external Kubernetes cluster (site type for existing K8s clusters owned by
      # customer organization). Supports Mesh only, not AppStack. Different from
      # managed Kubernetes configuration objects accessed via kubernetes domain APIs.
      - "k8s_cluster"
      - "site_management"
      - "\\.site\\."

  # ===== B. Security - Core (4 categories) =====
  api:
    description: "API security, discovery, and testing"
    patterns:
      - "api_sec\\."
      - "api_crawler"
      - "api_credential"
      - "api_definition"
      - "api_discovery"
      - "api_group"
      - "api_testing"
      - "code_base_integration"

  application_firewall:
    description: "Web application firewall"
    patterns:
      - "app_firewall"
      - "app_security"
      - "enhanced_firewall"
      - "protocol_inspection"
      - "waf"

  bot_defense:
    description: "Bot defense and threat intelligence"
    patterns:
      - "bot_allowlist"
      - "bot_defense"
      - "bot_endpoint"
      - "bot_infrastructure"
      - "bot_network"
      - "mobile_base"
      - "mobile_sdk"
      - "threat_intelligence"

  network_security:
    description: "Network firewall and policies"
    patterns:
      - "fast_acl"
      - "filter_set"
      - "forward_proxy"
      - "nat_policy"
      - "network_firewall"
      - "network_policy"
      - "policy_based_routing"
      - "segment"

  # ===== C. Security - Advanced (4 categories) =====
  blindfold:
    description: "Secret policy and encryption"
    patterns:
      - "secret_policy"

  client_side_defense:
    description: "Data privacy and protection"
    patterns:
      - "client_side_defense"
      - "data_privacy"
      - "data_type"
      - "device_id"
      - "sensitive_data_policy"

  ddos:
    description: "Distributed denial of service protection"
    patterns:
      - "infraprotect"

  dns:
    description: "DNS load balancing"
    patterns:
      - "dns_compliance"
      - "dns_domain"
      - "dns_and_domain_management"
      - "dns_lb_"
      - "dns_load_balancer"
      - "dns_zone"
      - "rrset"

  virtual:
    description: "Application Delivery Controller"
    patterns:
      - "geo_location_set"
      - "malicious_user"
      - "malware_protection"
      - "service_policy"
      - "threat_campaign"
      - "views\\.forward_proxy_policy"
      - "views\\.http_loadbalancer"
      - "views\\.origin_pool"
      - "views\\.proxy\\.ves"
      - "views\\.rate_limiter_policy"
      - "views\\.tcp_loadbalancer"
      - "views\\.udp_loadbalancer"
      - "(?<!dns_lb)\\.healthcheck\\.ves"
      - "\\.virtual_host\\.ves"
      - "^[^.]*\\.route\\.ves"

  virtual_server:
    description: "Virtual Server and HTTP Load Balancing"
    patterns:
      - "http_loadbalancer"
      - "views\\.http_loadbalancer"

  network:
    description: "Routing, Tunnelling, and Network Connectivity"
    patterns:
      - "address_allocator"
      - "advertise_policy"
      - "bgp"
      - "bgp_asn"
      - "bgp_routing"
      - "dc_cluster_group"
      - "forwarding_class"
      - "ike1"
      - "ike2"
      - "ike_phase"
      - "ip_prefix_set"
      - "network_connector"
      - "public_ip"
      - "route"
      - "segment_connection"
      - "srv6"
      - "subnet"
      - "tunnel"

  cdn:
    description: "Content delivery network services"
    patterns:
      - "cdn_"
      - "cdn_cache"
      - "cdn_loadbalancer"
      - "data_delivery"

  observability:
    description: "Synthetic monitoring and testing"
    patterns:
      - "observability\\."
      - "observability_and_analytics"
      - "synthetic_monitor"

  statistics:
    description: "Statistics"
    patterns:
      - "alert"
      - "alert_policy"
      - "alert_receiver"
      - "brmalerts"
      - "discovered_service"
      - "flow"
      - "global_log_receiver"
      - "graph"
      - "log"
      - "log_receiver"
      - "report"
      - "status_at_site"
      - "topology"

  support:
    description: "Support and ticket tracking"
    patterns:
      - "customer_support"
      - "operate\\."
      - "ticket_tracking"

  authentication:
    description: "Authentication and identity providers"
    patterns:
      - "authentication"
      - "oidc_provider"
      - "scim"
      - "signup"
      - "api_credential"

  system:
    description: "Tenant management and core system"
    patterns:
      - "contact"
      - "namespace"
      - "rbac_policy"
      - "role"
      - "tenant"
      - "tenant_management"
      - "user"
      - "user_group"

  users:
    description: "User accounts and settings"
    patterns:
      - "implicit_label"
      - "known_label"
      - "token"
      - "user_identification"
      - "user_setting"
      - "was\\.user"

  # ===== I. Platform & Integrations (3 categories) =====
  bigip:
    description: "BigIP"
    patterns:
      - "bigcne"
      - "bigip"
      - "data_group"
      - "irule"

  marketplace:
    description: "Platform marketplace and integrations"
    patterns:
      - "addon_"
      - "cminstance"
      - "marketplace"
      - "pbac\\."
      - "stored_object"
      - "tpm_"
      - "voltshare"
      - "views\\.external"
      - "views\\.terraform"
      - "views\\.third_party"
      - "views\\.view_internal"

  nginx_one:
    description: "NGINX One management platform"
    patterns:
      - "nginx"

  # ===== J. Advanced & Emerging (5 categories) =====
  certificates:
    description: "Certificate Management"
    patterns:
      - "certificate"
      - "config"
      - "crl"
      - "manifest"
      - "trusted_ca"

  generative_ai:
    description: "AI and machine learning features"
    patterns:
      - "ai_assistant"
      - "ai_data"
      - "flow_anomaly"
      - "\\.gia\\."

  rate_limiting:
    description: "Rate limiting"
    patterns:
      - "policer"
      - "rate_limiter"

  shape:
    description: "Shape Security"
    patterns:
      - "shape\\.recognize"
      - "shape\\.safe"
      - "shape\\.safeap"

  # ===== K. UI & Platform Infrastructure (3 categories) =====
  admin:
    description: "Administration console and user interface"
    patterns:
      - "navigation_tile"
      - "ui\\."
      - "ui_static"

  billing:
    description: "Billing, subscription, and usage"
    patterns:
      - "billing\\."
      - "payment_method"
      - "plan_transition"
      - "quota"
      - "subscription"
      - "usage"
      - "usage_invoice"

  label:
    description: "Labels and compliance management"
    patterns:
      - "label"
