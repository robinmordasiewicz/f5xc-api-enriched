# Domain categorization patterns for F5 XC API specifications
# Single source of truth for mapping spec filenames to functional domains
version: "1.0.0"
description: "31 functional domains aligned with F5 XC Terraform provider"

domains:
  # ===== A. Infrastructure & Deployment (5 categories) =====
  site_management:
    description: "Cloud sites, K8s clusters, site infrastructure"
    patterns:
      - "aws_vpc_site"
      - "aws_tgw_site"
      - "azure_vnet_site"
      - "gcp_vpc_site"
      - "voltstack_site"
      - "securemesh_site"
      - "k8s_cluster"
      - "virtual_k8s"
      - "virtual_site"
      - "\\.site\\."

  cloud_infrastructure:
    description: "Cloud connectivity and credentials"
    patterns:
      - "cloud_credentials"
      - "cloud_connect"
      - "cloud_elastic"
      - "cloud_link"
      - "cloud_region"
      - "certified_hardware"

  vpm_and_node_management:
    description: "VPM, node management, upgrades"
    patterns:
      - "registration"
      - "module_management"
      - "upgrade_status"
      - "maintenance_status"
      - "usb_policy"
      - "network_interface"

  kubernetes_and_orchestration:
    description: "Kubernetes and container orchestration"
    patterns:
      - "k8s_cluster"
      - "k8s_pod_security"
      - "virtual_appliance"
      - "workload"
      - "container_registry"
      - "\\.cluster\\."

  service_mesh:
    description: "Service mesh and virtual networking"
    patterns:
      - "site_mesh"
      - "virtual_network"
      - "virtual_host"
      - "endpoint"
      - "nfv_service"
      - "fleet"
      - "discovery"
      - "app_setting"
      - "app_type"

  # ===== B. Security - Core (4 categories) =====
  app_firewall:
    description: "Web application firewall and protection"
    patterns:
      - "app_firewall"
      - "app_security"
      - "waf"
      - "protocol_inspection"
      - "enhanced_firewall"

  api_security:
    description: "API security, discovery, and testing"
    patterns:
      - "api_sec\\."
      - "api_crawler"
      - "api_discovery"
      - "api_testing"
      - "api_group"
      - "code_base_integration"
      - "api_credential"
      - "api_definition"

  bot_and_threat_defense:
    description: "Bot defense and threat intelligence"
    patterns:
      - "bot_defense"
      - "bot_allowlist"
      - "bot_endpoint"
      - "bot_infrastructure"
      - "bot_network"
      - "mobile_sdk"
      - "mobile_base"
      - "threat_intelligence"

  network_security:
    description: "Network firewall and policies"
    patterns:
      - "network_firewall"
      - "network_policy"
      - "nat_policy"
      - "forward_proxy"
      - "fast_acl"
      - "policy_based_routing"
      - "service_policy"
      - "segment"
      - "filter_set"

  # ===== C. Security - Advanced (3 categories) =====
  data_and_privacy_security:
    description: "Data privacy and protection"
    patterns:
      - "sensitive_data_policy"
      - "data_privacy"
      - "client_side_defense"
      - "device_id"
      - "data_type"

  ddos:
    description: "Distributed denial of service protection"
    patterns:
      - "infraprotect"

  blindfold:
    description: "Secret policy and encryption"
    patterns:
      - "secret_policy"

  secops_and_incident_response:
    description: "Security operations and incident response"
    patterns:
      - "secret_management"
      - "malicious_user"

  # ===== D. Application Delivery (2 categories) =====
  virtual_server:
    description: "Load balancers and application delivery"
    patterns:
      - "views\\.http_loadbalancer"
      - "views\\.tcp_loadbalancer"
      - "views\\.udp_loadbalancer"
      - "threat_campaign"
      - "geo_location_set"
      - "views\\.origin_pool"
      - "(?<!dns_lb)\\.healthcheck\\.ves"
      - "\\.virtual_host\\.ves"
      - "^[^.]*\\.route\\.ves"
      - "views\\.rate_limiter_policy"
      - "views\\.proxy\\.ves"
      - "views\\.forward_proxy_policy"
      - "malware_protection"

  dns:
    description: "DNS load balancing and domain management"
    patterns:
      - "dns_load_balancer"
      - "dns_zone"
      - "dns_domain"
      - "dns_compliance"
      - "dns_lb_"
      - "rrset"

  # ===== E. Connectivity & Networking (2 categories) =====
  network:
    description: "BGP routing and network connectivity"
    patterns:
      - "bgp_routing"
      - "bgp"
      - "bgp_asn"
      - "route"
      - "tunnel"
      - "segment_connection"
      - "network_connector"
      - "ip_prefix_set"
      - "advertise_policy"
      - "subnet"
      - "srv6"
      - "address_allocator"
      - "public_ip"
      - "forwarding_class"
      - "dc_cluster_group"

  site_to_site:
    description: "VPN and site-to-site connectivity"
    patterns:
      - "ike1"
      - "ike2"
      - "ike_phase"

  # ===== F. Content & Performance (2 categories) =====
  cdn:
    description: "Content delivery network services"
    patterns:
      - "cdn_loadbalancer"
      - "cdn_cache"
      - "cdn_"
      - "data_delivery"

  # ===== G. Observability (4 categories) =====
  observability_and_analytics:
    description: "Monitoring, alerting, and analytics"
    patterns:
      - "synthetic_monitor"
      - "alert_policy"
      - "alert_receiver"
      - "alert"
      - "log_receiver"
      - "global_log_receiver"
      - "log"
      - "report"
      - "observability\\."
      - "brmalerts"

  synthetic_monitoring:
    description: "Synthetic monitoring and testing"
    patterns:
      - "synthetic_monitor"

  telemetry_and_insights:
    description: "Telemetry, graphs, and flow analysis"
    patterns:
      - "graph"
      - "topology"
      - "flow"
      - "discovered_service"
      - "status_at_site"

  support:
    description: "Support and ticket tracking"
    patterns:
      - "operate\\."
      - "ticket_tracking"
      - "customer_support"

  # ===== H. Enterprise & Administration (3 categories) =====
  tenant_and_identity_management:
    description: "Tenant management and identity"
    patterns:
      - "tenant_management"
      - "tenant"
      - "namespace"
      - "user_group"
      - "user"
      - "rbac_policy"
      - "role"
      - "authentication"
      - "oidc_provider"
      - "scim"
      - "signup"
      - "contact"

  user_and_account_management:
    description: "User accounts and settings"
    patterns:
      - "user_setting"
      - "user_identification"
      - "implicit_label"
      - "known_label"
      - "token"
      - "was\\.user"

  # ===== I. Platform & Integrations (3 categories) =====
  bigip_integration:
    description: "BigIP and legacy system integration"
    patterns:
      - "bigip"
      - "bigcne"
      - "irule"
      - "data_group"

  nginx_one_management:
    description: "NGINX One management platform"
    patterns:
      - "nginx"

  marketplace:
    description: "Platform marketplace and integrations"
    patterns:
      - "marketplace"
      - "pbac\\."
      - "addon_"
      - "tpm_"
      - "cminstance"
      - "voltshare"
      - "views\\.third_party"
      - "views\\.terraform"
      - "views\\.external"
      - "views\\.view_internal"

  # ===== J. Advanced & Emerging (4 categories) =====
  generative_ai:
    description: "AI and machine learning features"
    patterns:
      - "ai_assistant"
      - "ai_data"
      - "flow_anomaly"
      - "shape\\.recognize"
      - "shape\\.safe"
      - "shape\\.safeap"
      - "\\.gia\\."

  rate_limiting_and_quotas:
    description: "Rate limiting and quota management"
    patterns:
      - "rate_limiter"
      - "policer"

  configuration_and_deployment:
    description: "Configuration and certificate management"
    patterns:
      - "manifest"
      - "certificate"
      - "config"
      - "trusted_ca"
      - "crl"

  object_store:
    description: "Object storage services"
    patterns:
      - "stored_object"

  # ===== K. UI & Platform Infrastructure (2 categories) =====
  admin_console_and_ui:
    description: "Administration console and user interface"
    patterns:
      - "ui_static"
      - "ui\\."
      - "navigation_tile"

  billing_and_usage:
    description: "Billing, subscription, and usage"
    patterns:
      - "billing\\."
      - "usage"
      - "subscription"
      - "payment_method"
      - "plan_transition"
      - "quota"
      - "usage_invoice"

  compliance_and_governance:
    description: "Labels and compliance management"
    patterns:
      - "label"
