# Domain categorization patterns for F5 XC API specifications
# Single source of truth for mapping spec filenames to functional domains
#
# PATTERN MATCHING RULES:
#   - Patterns are matched sequentially by domain order
#   - First matching pattern determines domain assignment
#   - Both literal strings and regex patterns are supported
#
# COMPLEX PATTERNS DOCUMENTED:
#   - (?<!dns_lb)\.healthcheck\.ves: Matches healthcheck.ves EXCEPT dns_lb_*
#     (negative lookahead pattern)
#   - ^[^.]*\.route\.ves: Matches route.ves specs at root namespace level
#   - api_sec\.: Regex - matches API security specs with dot separator
#   - \.site\.: Regex - matches site-related specs using dot separators
#   - Note: k8s_cluster appears in both site_management and
#     kubernetes_and_orchestration (site_management takes priority)
#
version: "1.0.0"
description: >
  33 functional domains organized in 11 categories, aligned with
  F5 XC platform services

domains:
  # ===== A. Infrastructure & Deployment (5 categories) =====
  ce_management:
    description: "Customer Edge"
    patterns:
      - "registration"
      - "module_management"
      - "upgrade_status"
      - "maintenance_status"
      - "usb_policy"
      - "network_interface"

  cloud_infrastructure:
    description: "Cloud connectivity and credentials"
    patterns:
      - "cloud_credentials"
      - "cloud_connect"
      - "cloud_elastic"
      - "cloud_link"
      - "cloud_region"
      - "certified_hardware"

  kubernetes_and_orchestration:
    description: "Kubernetes and container orchestration"
    patterns:
      - "k8s_cluster"
      - "k8s_pod_security"
      - "virtual_appliance"
      - "workload"
      - "container_registry"
      - "\\.cluster\\."

  service_mesh:
    description: "Service mesh and virtual networking"
    patterns:
      - "site_mesh"
      - "virtual_network"
      - "virtual_host"
      - "endpoint"
      - "nfv_service"
      - "fleet"
      - "discovery"
      - "app_setting"
      - "app_type"

  site_management:
    description: "Sites"
    patterns:
      - "aws_vpc_site"
      - "aws_tgw_site"
      - "azure_vnet_site"
      - "gcp_vpc_site"
      - "voltstack_site"
      - "securemesh_site"
      - "k8s_cluster"
      - "virtual_k8s"
      - "virtual_site"
      - "\\.site\\."

  # ===== B. Security - Core (4 categories) =====
  api:
    description: "API security, discovery, and testing"
    patterns:
      - "api_sec\\."
      - "api_crawler"
      - "api_credential"
      - "api_definition"
      - "api_discovery"
      - "api_group"
      - "api_testing"
      - "code_base_integration"

  app_firewall:
    description: "Web application firewall"
    patterns:
      - "app_firewall"
      - "app_security"
      - "enhanced_firewall"
      - "protocol_inspection"
      - "waf"

  bot_and_threat_defense:
    description: "Bot defense and threat intelligence"
    patterns:
      - "bot_allowlist"
      - "bot_defense"
      - "bot_endpoint"
      - "bot_infrastructure"
      - "bot_network"
      - "mobile_base"
      - "mobile_sdk"
      - "threat_intelligence"

  network_security:
    description: "Network firewall and policies"
    patterns:
      - "fast_acl"
      - "filter_set"
      - "forward_proxy"
      - "nat_policy"
      - "network_firewall"
      - "network_policy"
      - "policy_based_routing"
      - "segment"

  # ===== C. Security - Advanced (4 categories) =====
  blindfold:
    description: "Secret policy and encryption"
    patterns:
      - "secret_policy"

  data_and_privacy_security:
    description: "Data privacy and protection"
    patterns:
      - "client_side_defense"
      - "data_privacy"
      - "data_type"
      - "device_id"
      - "sensitive_data_policy"

  ddos:
    description: "Distributed denial of service protection"
    patterns:
      - "infraprotect"

  secops_and_incident_response:
    description: "Security operations and incident response"
    patterns:
      - "malicious_user"
      - "secret_management"

  # ===== D. Application Delivery (2 categories) =====
  dns:
    description: "DNS load balancing and domain management"
    patterns:
      - "dns_compliance"
      - "dns_domain"
      - "dns_lb_"
      - "dns_load_balancer"
      - "dns_zone"
      - "rrset"

  virtual_server:
    description: "Load balancers and application delivery"
    patterns:
      - "geo_location_set"
      - "malware_protection"
      - "service_policy"
      - "threat_campaign"
      - "views\\.forward_proxy_policy"
      - "views\\.http_loadbalancer"
      - "views\\.origin_pool"
      - "views\\.proxy\\.ves"
      - "views\\.rate_limiter_policy"
      - "views\\.tcp_loadbalancer"
      - "views\\.udp_loadbalancer"
      - "(?<!dns_lb)\\.healthcheck\\.ves"
      - "\\.virtual_host\\.ves"
      - "^[^.]*\\.route\\.ves"

  # ===== E. Connectivity & Networking (1 category) =====
  network:
    description: "Routing, Tunnelling, and Network Connectivity"
    patterns:
      - "address_allocator"
      - "advertise_policy"
      - "bgp"
      - "bgp_asn"
      - "bgp_routing"
      - "dc_cluster_group"
      - "forwarding_class"
      - "ike1"
      - "ike2"
      - "ike_phase"
      - "ip_prefix_set"
      - "network_connector"
      - "public_ip"
      - "route"
      - "segment_connection"
      - "srv6"
      - "subnet"
      - "tunnel"

  # ===== F. Content & Performance (1 category) =====
  cdn:
    description: "Content delivery network services"
    patterns:
      - "cdn_"
      - "cdn_cache"
      - "cdn_loadbalancer"
      - "data_delivery"

  # ===== G. Observability (3 categories) =====
  observability:
    description: "Synthetic monitoring and testing"
    patterns:
      - "observability\\."
      - "synthetic_monitor"

  statistics:
    description: "Statistics"
    patterns:
      - "alert"
      - "alert_policy"
      - "alert_receiver"
      - "brmalerts"
      - "discovered_service"
      - "flow"
      - "global_log_receiver"
      - "graph"
      - "log"
      - "log_receiver"
      - "report"
      - "status_at_site"
      - "topology"

  support:
    description: "Support and ticket tracking"
    patterns:
      - "customer_support"
      - "operate\\."
      - "ticket_tracking"

  # ===== H. Enterprise & Administration (2 categories) =====
  tenant_and_identity:
    description: "Tenant management and identity"
    patterns:
      - "authentication"
      - "contact"
      - "namespace"
      - "oidc_provider"
      - "rbac_policy"
      - "role"
      - "scim"
      - "signup"
      - "tenant"
      - "tenant_management"
      - "user"
      - "user_group"

  users:
    description: "User accounts and settings"
    patterns:
      - "implicit_label"
      - "known_label"
      - "token"
      - "user_identification"
      - "user_setting"
      - "was\\.user"

  # ===== I. Platform & Integrations (3 categories) =====
  bigip:
    description: "BigIP and legacy system integration"
    patterns:
      - "bigcne"
      - "bigip"
      - "data_group"
      - "irule"

  marketplace:
    description: "Platform marketplace and integrations"
    patterns:
      - "addon_"
      - "cminstance"
      - "marketplace"
      - "pbac\\."
      - "tpm_"
      - "voltshare"
      - "views\\.external"
      - "views\\.terraform"
      - "views\\.third_party"
      - "views\\.view_internal"

  nginx_one:
    description: "NGINX One management platform"
    patterns:
      - "nginx"

  # ===== J. Advanced & Emerging (5 categories) =====
  certificates:
    description: "Certificate Management"
    patterns:
      - "certificate"
      - "config"
      - "crl"
      - "manifest"
      - "trusted_ca"

  generative_ai:
    description: "AI and machine learning features"
    patterns:
      - "ai_assistant"
      - "ai_data"
      - "flow_anomaly"
      - "\\.gia\\."

  object_storage:
    description: "Object storage services"
    patterns:
      - "stored_object"

  rate_limiting:
    description: "Rate limiting"
    patterns:
      - "policer"
      - "rate_limiter"

  shape:
    description: "Shape Security"
    patterns:
      - "shape\\.recognize"
      - "shape\\.safe"
      - "shape\\.safeap"

  # ===== K. UI & Platform Infrastructure (3 categories) =====
  admin_console_and_ui:
    description: "Administration console and user interface"
    patterns:
      - "navigation_tile"
      - "ui\\."
      - "ui_static"

  billing_and_usage:
    description: "Billing, subscription, and usage"
    patterns:
      - "billing\\."
      - "payment_method"
      - "plan_transition"
      - "quota"
      - "subscription"
      - "usage"
      - "usage_invoice"

  label:
    description: "Labels and compliance management"
    patterns:
      - "label"
