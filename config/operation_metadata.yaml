enabled: true
extension_prefix: 'x-ves'

# HTTP method base danger levels
danger_levels:
  method_base_levels:
    GET: 'low'
    HEAD: 'low'
    OPTIONS: 'low'
    POST: 'medium'
    PUT: 'medium'
    PATCH: 'medium'
    DELETE: 'high'
    TRACE: 'low'

  # Patterns that escalate danger levels
  escalation_patterns:
    - pattern: 'DELETE.*/namespace$'
      level: 'high'
      reason: 'Deletes entire namespace and contained resources'

    - pattern: 'DELETE.*/(security|firewall|policy|authentication)/'
      level: 'high'
      reason: 'Security-critical deletion'

    - pattern: 'POST.*/(system|global)_'
      level: 'medium'
      reason: 'System-level operation affects tenant-wide configuration'

    - pattern: 'DELETE.*/tenant'
      level: 'high'
      reason: 'Deletes entire tenant'

# Standard fields required for create operations
required_fields:
  standard_create_fields:
    - 'metadata.name'
    - 'metadata.namespace'
  comment: 'F5 XC API standard - applies to POST operations creating resources'

# Side effect determination
side_effects:
  method_effects:
    POST: 'creates'
    PUT: 'modifies'
    PATCH: 'modifies'
    DELETE: 'deletes'

# CLI example generation
cli_examples:
  generate_examples: true
  max_examples_per_operation: 3
  formats:
    get_specific: 'f5xcctl {domain} {resource} get {name} --namespace {namespace}'
    list_all: 'f5xcctl {domain} {resource} list --namespace {namespace}'
    basic_create: 'f5xcctl {domain} {resource} create {name} --namespace {namespace}'
    file_based: 'f5xcctl {domain} {resource} create -f {file}.yaml'
    update: 'f5xcctl {domain} {resource} update {name} --namespace {namespace} -f {file}.yaml'
    delete: 'f5xcctl {domain} {resource} delete {name} --namespace {namespace}'

# Operation Metadata Extensions:
# ===============================
#
# x-ves-required-fields (array of strings)
# - List of required field paths for the operation
# - Format: "fieldName" or "parent.child" for nested
# - Example: ["metadata.name", "metadata.namespace", "spec.protocol"]
#
# x-ves-optional-fields (array of strings)
# - List of optional but recommended fields
# - Same format as required fields
#
# x-ves-danger-level (string)
# - Risk classification: "low" | "medium" | "high"
# - low: Read-only operations (GET, HEAD, OPTIONS)
# - medium: Create/update operations (POST, PUT, PATCH) or system operations
# - high: Destructive operations (DELETE) or security-critical changes
#
# x-ves-confirmation-required (boolean)
# - Whether CLI tools should prompt for confirmation
# - Automatically true for danger_level: "high"
#
# x-ves-side-effects (object)
# - Documents what the operation creates/modifies/deletes
# - Fields: creates[], modifies[], deletes[] (arrays of resource types)
# - Example: {creates: ["http_loadbalancer"], modifies: [], deletes: []}
#
# x-ves-cli-examples (array of objects)
# - Provides CLI usage examples for the operation
# - Each example: {description, command, use_case, warning?}
# - Warning field optional, for dangerous operations
#
# Danger Level Algorithm:
# =======================
#
# 1. Start with method base level:
#    - GET/HEAD/OPTIONS → "low"
#    - POST/PUT/PATCH → "medium"
#    - DELETE → "high"
#
# 2. Check escalation patterns:
#    - Match against {METHOD} {PATH}
#    - If match found, return escalated level
#
# 3. Check for dangerous parameters:
#    - If operation has force/cascade flags
#    - Escalate: low→medium, medium→high
#
# 4. Final level is returned
#
# Examples:
# ---------
# GET /api/config/...
#   Base: low → Final: low
#
# DELETE /api/config/.../http_loadbalancers/{name}
#   Base: high → Escalation check: no match → Final: high
#
# DELETE /api/config/.../namespaces/{namespace}
#   Base: high → Escalation: DELETE.*/namespace → Final: high + confirm_required
#
# POST /api/config/.../system_settings
#   Base: medium → Escalation: POST.*/(system|global)_ → Final: medium
#
# Future Enhancement Opportunities:
# ==================================
# - Add custom danger level overrides per operation (operationId)
# - Add templated example generation from OpenAPI examples
# - Add validation rule extraction from requestBody schema
# - Add response code side effect mapping (201=create, 204=delete, etc.)
